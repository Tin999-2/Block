<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Game Speed Adjusted</title>
    <style>
        body { background: #1a1a1a; margin: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; color: white; overflow: hidden; touch-action: none; font-family: sans-serif; }
        canvas { background: #000; border: 2px solid #fff; width: 95vw; max-width: 480px; height: auto; }
        .ui { display: none; position: absolute; background: rgba(0,0,0,0.95); padding: 30px; text-align: center; border: 3px solid #fff; z-index: 100; border-radius: 10px; }
        button { padding: 12px 24px; font-size: 1.1rem; cursor: pointer; background: #444; color: white; border: 1px solid #fff; border-radius: 5px; margin-top: 10px; }
    </style>
</head>
<body>
    <div style="margin-bottom:10px;">Destroy All the Blocks</div>
    <canvas id="g" width="480" height="480"></canvas>
    
    <div id="clr" class="ui"><h2>COMPLETE!</h2><p>Keyword: wall</p>
    <!-- 
        <button onclick="location.reload()">Retry</button>
    -->
    </div>
    <div id="ovr" class="ui"><h2>GAME OVER</h2>
     <!--
        <button onclick="location.reload()">Retry</button>
    -->
    </div>

    <script>
    var cvs = document.getElementById("g");
    var ctx = cvs.getContext("2d");
    
    // --- 速度設定のロジック ---
    // スマホ（タッチ操作があるか）を判定して速度を分ける
    var isTouch = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
    
    // PCは 2.5（少し遅く）、スマホは 4.5（速く）に設定
    var speed = isTouch ? 4.5 : 2.5;
    
    var x = 240, y = 440, dx = speed, dy = -speed;
    var pX = 190, active = true, count = 0;
    var rows = 5, cols = 8, bW = 50, bH = 20, bP = 8, bOT = 50, bOL = 12;
    var colors = ['#e74c3c', '#3498db', '#f1c40f', '#9b59b6', '#e67e22'];
    var bricks = [];

    for(var c=0; c<cols; c++) {
        bricks[c] = [];
        for(var r=0; r<rows; r++) bricks[c][r] = { status: 1 };
    }

    function move(e) {
        var rect = cvs.getBoundingClientRect();
        var cx = (e.touches ? e.touches[0].clientX : e.clientX);
        pX = (cx - rect.left) * (480 / rect.width) - 50;
    }
    window.onmousemove = move;
    window.ontouchmove = function(e) { move(e); e.preventDefault(); };

    function draw() {
        if(!active) return;
        ctx.clearRect(0, 0, 480, 480);
        
        for(var c=0; c<cols; c++) {
            for(var r=0; r<rows; r++) {
                var b = bricks[c][r];
                if(b.status == 1) {
                    var bx = c*(bW+bP)+bOL;
                    var by = r*(bH+bP)+bOT;
                    ctx.fillStyle = colors[r];
                    ctx.fillRect(bx, by, bW, bH);
                    if(x > bx && x < bx+bW && y > by && y < by+bH) {
                        dy = -dy; b.status = 0; count++;
                        if(count == rows*cols) { 
                            active = false; 
                            document.getElementById("clr").style.display="block"; 
                        }
                    }
                }
            }
        }

        ctx.fillStyle = "#fff";
        ctx.beginPath(); ctx.arc(x, y, 10, 0, Math.PI*2); ctx.fill();
        ctx.fillRect(pX, 460, 100, 15);

        if(x+dx > 470 || x+dx < 10) dx = -dx;
        if(y+dy < 10) dy = -dy;
        else if(y+dy > 450) {
            if(x > pX && x < pX+100) { 
                dy = -speed; // パドルで打つときも設定したスピードを維持
                y = 449; 
            }
            else if(y > 485) { 
                active = false; 
                document.getElementById("ovr").style.display="block"; 
            }
        }
        x+=dx; y+=dy;
        requestAnimationFrame(draw);
    }
    draw();
    </script>
</body>
</html>


